{% extends "cate/site_base.html" %}
{% load i18n %}
{% load static %}

{% block page-title %}Inscription{% endblock %}

{% block js %}
{{ block.super }}
<script src="{% url "javascript-catalog" %}"></script>
<script>
{% url "account_email" as email_url %}
var emailURL = "{{ email_url|escapejs }}";
var csrftoken = "{{ csrf_token|escapejs }}";
</script>
<script src="{% static "common/subscription.js" %}"></script>
{% endblock js %}

{% block content %}
<h1>
	Inscription
	<small>
		(en cas de problème, merci de <a href="{% url "page" "contacts" %}">contacter Carine</a>)
	</small>
</h1>
<div class="columns">
<div class="form-center">
<h2>Enfants à inscrire</h2>
{% if not children and not registered_children %}
	<p>
		Est-ce la première année que votre enfant vient au caté ou à l'aumônerie ?
	</p>
	<ul class="registering-onboarding">
		<li>Si oui : <a href="{% url "inscription_nouveau" %}">Inscrire un nouvel enfant</a></li>
		<li class="help-subscription">Si non : <a href="#">{% trans "I can't find my child" %}</a></li>
	</ul>
{% else %}
	<ul class="children-to-register">
		{% for child in children %}
			<li><a href="{% url "inscription_ancien" child.id %}">Réinscrire {{ child }} pour l'année scolaire {{ year.formatted_year }}</a></li>
		{% endfor %}
		<li><a href="{% url "inscription_nouveau" %}">Inscrire un nouvel enfant</a></li>
	</ul>
	<p class="help-subscription">
		<a class="label-help shine" href="#">{% trans "I can't find my child" %}</a>
	</p>
{% endif %}
</div>
<div class="form-center">
<h2>Enfants inscrits</h2>
{% if not registered_children %}
	<p class="wide-screen">
		Inscrivez des enfants dans le volet de gauche et ils apparaîtront ici.
	</p>
	<p class="narrow-screen">
		Inscrivez des enfants dans le volet du dessus et ils apparaîtront ici.
	</p>
{% else %}
	<ul class="registered-children">
		{% for child in registered_children %}
			<li>
				{{ child }} a été inscrit·e
				<br>
				<span class="label-{{ child.paye|yesno:"ok,error" }}">
					{% if child.paye %}
						Payé
					{% else %}
						Non payé
					{% endif %}
				</span>
				<br>
				<span class="label-{{ child.signe|yesno:"ok,error" }}">
					{% if child.signe %}
						Signé
					{% else %}
						Non signé
					{% endif %}
				</span>
				{% if not child.signe %}
					· <a
						class="pdf-link"
						href="{% url "autorisation" %}?0={{ child.pk }}"
						target="_blank"
						{% if child.has_two_parents %}data-needs-parent-type{% endif %}
					>Autorisation</a>
				{% endif %}
			</li>
		{% endfor %}
	</ul>
{% endif %}
</div>
</div>
{% endblock %}
