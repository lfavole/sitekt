{% extends "cate/base.html" %}
{% load i18n %}
{% load static %}
{% load nav %}

{% block body %}
<input
    type="checkbox"
    id="menu-checkbox"
    class="sr-only"
    x-data="{ close() {if(window.matchMedia('(min-width: 501px)').matches) $el.checked = false} }"
    x-init="close"
    @resize.window="close"
>
<header>
    <div class="header__left">
        <label class="nav__button" for="menu-checkbox">â‰¡</label>
    </div>
    <div class="header__center">
        <img class="header__logo" src="{% static "favicon.png" %}">
        <div class="header__title">{% block title-header %}{{ SITE_NAME }}{% endblock %}</div>
    </div>
    <div class="header__right">
        {% if user.is_authenticated %}
        <div
            class="user-info"
            x-data="{ open: false }"
            :class="open ? 'user-info__open' : ''"
            @click.document="open = false"
        > <!-- @click.outside doesn't work because @click on button interferes with it -->
            <button class="user-info__button" @click.stop="open = !open">{{ user.username }}</button>
            <div class="user-info__menu" @click.stop>
                {% if user.is_staff %}
                <a href="{% url "admin:index" %}" target="_blank">{% trans "Administration" %}</a><br>
                {% endif %}
                <a href="{% url "account_index" %}">{% trans "Account" %}</a><br>
                <form method="post" action="{% url "account_logout" %}" class="form__inline">
                    {% csrf_token %}
                    <input type="submit" class="input__link" value="{% trans "Log out" %}">
                </form>
            </div>
        </div>
        {% else %}
        <div class="user-info">
            <a href="{% url "account_login" %}" class="user-info__button input input__button">{% trans "Log in" %}</a>
        </div>
        {% endif %}
    </div>
</header>
{% block navbar %}
<nav>
    <label class="nav__close_pane" for="menu-checkbox"></label>
    {% nav %}
</nav>
{% endblock navbar %}
<ul class="messagelist">
    {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
    {% endfor %}
</ul>
{% block main-content %}
<main class="{% block main-class %}{% endblock main-class %}">
{% block content %}{% endblock %}
</main>
{% endblock %}
{% endblock %}
